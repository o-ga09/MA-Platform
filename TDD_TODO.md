# 要件

## 実装対象

あなたは、あるe-sports大会で集められたゲームのエントリーファイルとプレイログファイルをもとに、ランキング上位10位までを算出することになりました。
このランキングを算出するCLIプログラムの開発をしてください。

## 仕様

- CLIである
- 入力ファイルからランキング上位10位までを算出すること
- 入力ファイルはcsv形式である

### 実行形式

~~~bash
./get_ranking game_ently_log.csv game_score_log.csv
~~~

### 入力ファイルの仕様

#### ゲームのエントリーファイルの構造

エントリーファイルは、大会にエントリーしたプレイヤーが記録されたファイルです。
エントリーは2列のCSV（引用符、改行なし）ファイルとして提供されます。

- 1行目は、ヘッダーとしてplayer_id,handle_nameと記載されています。
エントリーデータは2行目以降に記録されており、1行目のヘッダーの各項目に対応したデータが記載されています。
  - player_idはゲームにエントリーしているプレイヤーごとに一つずつ払い出された個別のIDで、全ての行で異なるplayer_idが割り当てられていることが保証されています。
  - handle_nameはエントリーしたユーザーのハンドルネームです。

- ハンドルネームは異なるプレイヤーであっても同じ名前を利用することができます。
- エントリーするプレイヤーの総数は1万人を超えることはありませんが、1万人を超えてもエラーとして処理をする必要はありません。

#### ゲームのプレイログファイルの構造

プレイログファイルは、プレイヤーがゲームをプレイしたタイミングで追記されたログファイルです。
このログファイルには、大会にエントリーしていないプレイヤーのプレイログも含まれています。
プレイログは3列のCSV（引用符、改行なし）ファイルとして提供されます。

- 1行目は、ヘッダーとしてcreate_timestamp,player_id,scoreと記載されています
- プレイログは2行目以降に記録されており、1行目のヘッダーの各項目に対応したデータが記載されています。
  - create_timestampはプレイヤーがこのゲームをプレイした日時を示しています。
    このログはcreate_timestampでソートされています。
  - player_idはゲームエントリーファイルで定義されるIDと同じものですが、大会にエントリーしていないプレイヤーにも一意に発行されています。

- 同一のプレイヤーが複数回のプレイを実施したときには、複数行のログが記録されます。
- 対象のプレイログ全体は数千万行以上に肥大化することがあります。

#### CSVファイル中の各要素のフォーマットについて

ゲームのプレイログファイルの各要素として以下の仕様で指定されたデータであることが予め担保されたデータとなっており、Validation不要で利用できます。

- create_timestamp は yyyy-MM-dd HH:ii:ss 形式の文字列です
- player_idはアルファベットの大文字、小文字、アンダースコア("_")、および数字の0-9のみで構成された1文字以上、20文字以下の文字列となります。
- handle_nameはアルファベットの大文字、小文字、アンダースコア("_")、および数字の0-9のみで構成された1文字以上、20文字以下の文字列となります。
- scoreはゲームで獲得した得点で、0以上の整数となります。

### ランキング抽出ルール

エントリーデータおよび、プレイデータをもとに、プレイヤー毎の最高得点によるランキングを作成してください。
大会にエントリーしていないプレイヤーのプレイデータは集計の対象としません。
プレイヤー毎の最高得点を後述するscoreの項目に出力してください。

### 正常処理時の出力ルール

- 下記のデータを標準出力に出力してください。
- 出力は4列のCSV形式としてください。（クオートは不要）
- 1行目はヘッダーとして、rank,player_id,handle_name,scoreを出力してください。
- 上記ヘッダーに準じて2列目以降を出力してください。
- rankの項目には最高得点の上位から1,2,3,…の数字を割り当ててください。
- scoreが同点のプレイヤーが居た場合、rankの数字は同じ数字を割り当ててください。
- score上位10名のプレイヤーが含まれるまでのランキングを出力してください。
- scoreが同点のプレイヤーが居た場合、10名以上がランキングに含まれることがあります。
- 同一ランクのプレイヤーが居た場合、player_idでソートしてください。
- 改行コードは[LF]としてください。

~~~bash
$ ./get_ranking game_ently_log.csv game_score_log.csv
rank,player_id,handle_name,score
1,player0001,HANDLE_NAME_1,10000
1,player0002,HANDLE_NAME_2,10000
3,player0003,HANDLE_NAME_3,9000
4,player0004,HANDLE_NAME_4,7000
5,player0005,HANDLE_NAME_5,1000
5,player0006,HANDLE_NAME_6,1000
7,player0007,HANDLE_NAME_7,998
8,player0008,HANDLE_NAME_8,997
9,player0009,HANDLE_NAME_9,990
9,player0010,HANDLE_NAME_10,990
9,player0011,HANDLE_NAME_11,990
9,player0012,HANDLE_NAME_12,990
~~~

### 異常系出力ルール

- 指定されたログファイルが存在しない場合や、ログファイルの内容が仕様と異なった場合などは、異常系として処理を中断してください。
- 異常系におけるメッセージは任意のメッセージを出力可能ですが、それらのメッセージは標準エラー出力として出力してください。
- 上記の場合において、標準出力には何も出力しないでください。
- 上記の場合において、プログラムを 0 以外の終了コードで終了させてください。
- 集計した結果、ランキングに入賞するレコードがなかった場合は異常系として扱わず、正常系として1行目のヘッダー行のみ出力してください。

~~~bash
$ ./get_ranking highscore
入力引数の数が不正です。
~~~

## タスク

- [x] csvファイルを読み込む
- [x] エントリユーザーのデータを取得する
- [x] プレイデータを取得する
- [x] プレイデータの中からエントリーユーザーのデータのみを残す
- [x] 各エントリーユーザーのデータの中で一番得点が高いレコードを保持する
- [x] ランキングデータとして一番得点が高いレコードを取得する
- [x] ランキングデータの得点が高い１０ユーザーを１〜１０までランク付けする
  - [x] 同じ得点の場合の場合は同じランクをつける
  - [x] 同じランクのユーザーが存在する場合player_idでソートする
  - [x] 改行文字はLF
  - [x] 同じランクのユーザーが存在する場合１０ユーザーを超えることがある
  - [x] 上位１０ユーザーが含まれるまでのランキングを出力する
- [ ] エラーメッセージは、標準エラー出力に出力する(標準出力に出力しない)
- [x] 異常系は処理を中断すること
- [x] 異常系は終了コードを0以外で終了すること
- [ ] 集計した結果、ランキングに入賞するレコードがなかった場合は異常系として扱わず、正常系として1行目のヘッダー行のみ出力する
